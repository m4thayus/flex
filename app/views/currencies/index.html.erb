<h1>Currencies</h1>

<script type="text/javascript">
  
  document.addEventListener('DOMContentLoaded', apiFetch())

  function apiFetch(){
    fetch("https://api.coindesk.com/v1/bpi/currentprice/XBT.json")
      .then(res => res.json())
      .then(jsonData => jsonData.forEach(currencyObj))
  };


  function currencyObj(jsonData){
    console.log(jsonData)
    let apiContainer = document.getElementById("api-render")
    let apiDiv = document.createElement("div")
    apiDiv.innerText = jsonData
    apiContainer.appendChild(apiDiv)
  };

</script>
  
<div id="api-title">
  <p>Current Exchange Rate:</p>
</div>
  <div id="api-render">

  </div>

<div id="carouselExampleControls" class="carousel slide" data-ride="carousel">
  <div class="carousel-inner">
    <% @currencies.each_with_index do |currency, index| %>
        <h2><%= link_to currency.name, currency %> (<%= currency.symbol %>)</h2>
    <% if index = 0 %>
        <div class="carousel-item active">
    <% else %>
        <div class="carousel-item">
    <% end %>
        <% if currency.image.attached? %>
            <%= image_tag currency.image, class: "d-block w-100", style: "height: 10rem;" %>
        <% end %>
    </div>
    <% end %>
  <a class="carousel-control-prev" href="#carouselExampleControls" role="button" data-slide="prev">
    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
    <span class="sr-only">Previous</span>
  </a>
  <a class="carousel-control-next" href="#carouselExampleControls" role="button" data-slide="next">
    <span class="carousel-control-next-icon" aria-hidden="true"></span>
    <span class="sr-only">Next</span>
  </a>
</div>
